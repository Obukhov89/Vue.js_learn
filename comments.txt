почему то не получилось с функцией деления по модулю, посмотрите в чем проблема?